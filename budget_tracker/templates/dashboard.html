{% extends 'base.html' %}
{% block content %}
    <h1 class="text-center">Budget Tracker Dashboard</h1>
    <div class="row">
        <div class="col-md-6">
            <h2>Financial Summary</h2>
            <div class="card mb-3">
                <div class="card-body">
                    <p><strong>Total Income:</strong> ${{ summary.total_income|floatformat:2 }}</p>
                    <p><strong>Total Expenses:</strong> ${{ summary.total_expenses|floatformat:2 }}</p>
                    <p><strong>Balance:</strong> ${{ summary.balance|floatformat:2 }}</p>
                </div>
            </div>
            <a href="{% url 'transaction_list' %}" class="btn btn-primary w-100">View Transactions</a>
        </div>
        <div class="col-md-6">
            <h2>Expense Breakdown</h2>
            <div class="chart-container">
                <canvas id="categoryChart"></canvas>
            </div>
        </div>
    </div>
    <script>
        const transactions = {{ transactions|safe }};
        const categories = {};
        transactions.filter(t => t.type === 'Expense').forEach(t => {
            const name = t.category.name;
            categories[name] = (categories[name] || 0) + parseFloat(t.amount);
        });
        const ctx = document.getElementById('categoryChart').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: Object.keys(categories),
                datasets: [{
                    data: Object.values(categories),
                    backgroundColor: ['#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF']
                }]
            },
            options: { responsive: true }
        });
    </script>
{% endblock %}